the webloop implementation has been taken from pyodide (https://github.com/pyodide/pyodide/blob/main/src/py/pyodide/webloop.py)
and has been modified to fit pyjs